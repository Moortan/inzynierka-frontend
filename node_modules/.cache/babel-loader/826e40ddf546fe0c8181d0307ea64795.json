{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sleniart/projects/react-front/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sleniart/projects/react-front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sleniart/projects/react-front/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import moment from'moment';import{verifyTokenAsync,userLogoutAsync}from\"../asyncActions/authAsyncActions\";import{userLogout,verifyTokenEnd}from\"../actions/authActions\";import{setAuthToken}from'../services/auth';import{getUserProfileService,getUserTeamsService}from'../services/user';function Profile(){var dispatch=useDispatch();var authObj=useSelector(function(state){return state.auth;});var user=authObj.user,token=authObj.token,expiredAt=authObj.expiredAt;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),userProfile=_useState2[0],setUserProfile=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),userTeams=_useState4[0],setUserTeams=_useState4[1];// handle click event of the logout button\nvar handleLogout=function handleLogout(){dispatch(userLogoutAsync());};// get user profile\nvar getUserProfile=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getUserProfileService();case 2:result=_context.sent;if(!result.error){_context.next=7;break;}dispatch(verifyTokenEnd());if(result.response&&[401,403].includes(result.response.status))dispatch(userLogout());return _context.abrupt(\"return\");case 7:setUserProfile(result.data);case 8:case\"end\":return _context.stop();}}},_callee);}));return function getUserProfile(){return _ref.apply(this,arguments);};}();var getUserTeams=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getUserTeamsService();case 2:result=_context2.sent;if(!result.error){_context2.next=7;break;}dispatch(verifyTokenEnd());if(result.response&&[401,403].includes(result.response.status))dispatch(userLogout());return _context2.abrupt(\"return\");case 7:setUserTeams(result.data.teams);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function getUserTeams(){return _ref2.apply(this,arguments);};}();// set timer to renew token\nuseEffect(function(){setAuthToken(token);var verifyTokenTimer=setTimeout(function(){dispatch(verifyTokenAsync(true));},moment(expiredAt).diff()-10*1000);return function(){clearTimeout(verifyTokenTimer);};},[expiredAt,token]);// get user items on page load\nuseEffect(function(){getUserProfile();getUserTeams();},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[\"Welcome \",user.username,\"!\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"button\",onClick:handleLogout,value:\"Logout\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"b\",{children:\"User Data:\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\" Email: \",userProfile.email,\" \"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\" Username: \",userProfile.name,\" \"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"b\",{children:\" Your Teams: \"}),/*#__PURE__*/_jsx(\"b\",{children:\" \"}),/*#__PURE__*/_jsx(\"p\",{id:\"teams\",children:\" \"}),userTeams.map(function(value,index){return/*#__PURE__*/_jsxs(\"li\",{children:[\" \",/*#__PURE__*/_jsx(\"br\",{}),\"Team Name: \",value.teamName,\" \",/*#__PURE__*/_jsx(\"br\",{}),\"Team Tag: \",value.teamTag,\" \",/*#__PURE__*/_jsx(\"br\",{}),\"Team Members: \",value.teamMembers[0],\", \",value.teamMembers[1],\",\",value.teamMembers[2],\", \",value.teamMembers[3],\", \",value.teamMembers[4],\" \",/*#__PURE__*/_jsx(\"br\",{}),\"Game: \",value.game,\" \",/*#__PURE__*/_jsx(\"br\",{})]},index);})]});}export default Profile;","map":{"version":3,"sources":["/Users/sleniart/projects/react-front/src/pages/Profile.js"],"names":["React","useEffect","useState","useDispatch","useSelector","moment","verifyTokenAsync","userLogoutAsync","userLogout","verifyTokenEnd","setAuthToken","getUserProfileService","getUserTeamsService","Profile","dispatch","authObj","state","auth","user","token","expiredAt","userProfile","setUserProfile","userTeams","setUserTeams","handleLogout","getUserProfile","result","error","response","includes","status","data","getUserTeams","teams","verifyTokenTimer","setTimeout","diff","clearTimeout","username","email","name","map","value","index","teamName","teamTag","teamMembers","game"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport moment from 'moment';\n\nimport { verifyTokenAsync, userLogoutAsync } from \"../asyncActions/authAsyncActions\";\nimport { userLogout, verifyTokenEnd } from \"../actions/authActions\";\n\nimport { setAuthToken } from '../services/auth';\nimport { getUserProfileService, getUserTeamsService } from '../services/user';\n\nfunction Profile() {\n\n  const dispatch = useDispatch();\n  const authObj = useSelector(state => state.auth);\n\n  const { user, token, expiredAt } = authObj;\n  const [userProfile, setUserProfile] = useState([]);\n  const [userTeams, setUserTeams] = useState([]);\n\n  // handle click event of the logout button\n  const handleLogout = () => {\n    dispatch(userLogoutAsync());\n  }\n\n  // get user profile\n  const getUserProfile = async () => {\n    const result = await getUserProfileService();\n    if (result.error) {\n      dispatch(verifyTokenEnd());\n      if (result.response && [401, 403].includes(result.response.status))\n        dispatch(userLogout());\n      return;\n    }\n    setUserProfile(result.data);\n  }\n\n  const getUserTeams = async () => {\n    const result = await getUserTeamsService();\n    if (result.error) {\n      dispatch(verifyTokenEnd());\n      if (result.response && [401, 403].includes(result.response.status))\n        dispatch(userLogout());\n      return;\n    }\n    setUserTeams(result.data.teams);\n  }\n\n  // set timer to renew token\n  useEffect(() => {\n    setAuthToken(token);\n    const verifyTokenTimer = setTimeout(() => {\n      dispatch(verifyTokenAsync(true));\n    }, moment(expiredAt).diff() - 10 * 1000);\n    return () => {\n      clearTimeout(verifyTokenTimer);\n    }\n  }, [expiredAt, token])\n\n  // get user items on page load\n  useEffect(() => {\n    getUserProfile();\n    getUserTeams();\n  }, []);\n\n  return (\n    <div>\n      Welcome {user.username}!<br /><br />\n      <input type=\"button\" onClick={handleLogout} value=\"Logout\" /><br /><br />\n      <b>User Data:</b>\n      <p> Email: {userProfile.email} </p>\n      <p> Username: {userProfile.name} </p>\n      <br />\n      <b> Your Teams: </b>\n      <b> </b>\n      <p id=\"teams\"> </p>\n      {userTeams.map((value, index) => {\n        return (\n          <li key={index}> <br />\n          Team Name: {value.teamName} <br />\n          Team Tag: {value.teamTag} <br />\n          Team Members: {value.teamMembers[0]}, {value.teamMembers[1]},\n          {value.teamMembers[2]}, {value.teamMembers[3]}, {value.teamMembers[4]} <br />\n          Game: {value.game} <br />\n\n          </li>\n        )\n      })}\n    </div>\n  );\n}\n\nexport default Profile;"]},"metadata":{},"sourceType":"module"}